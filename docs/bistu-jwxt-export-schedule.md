# BISTU教务系统课程表导出脚本

## 脚本信息
- **名称**: BISTU教务系统课表导出
- **版本**: 1.1.0
- **作者**: MRZZJ
- **许可证**: MIT

## 功能介绍
- 📅 导出教务系统课程表为CSV格式
- 📆 导出课程表为iCal格式，支持导入到日历应用
- 🔄 支持最新教务系统页面结构
- 🎯 导出后可导入到WakeUP课程表等第三方应用
- 🎓 自动获取学期周次信息，确保日历事件时间准确

## 安装方法
1. 浏览器安装油猴插件（Tampermonkey/Greasemonkey）
2. 点击 [课程表导出脚本](https://raw.githubusercontent.com/CN-MRZZJ/tampermonkey-scripts/main/bistu-jwxt-export-schedule.user.js) 安装

## 使用说明
1. 登录教务系统，进入课程表页面
2. 点击页面上的下拉菜单，选择导出格式：
   - **CSV**：导出为CSV格式，可导入到WakeUP课程表等应用
   - **iCal**：导出为iCal格式，可导入到Google日历、Apple日历等日历应用
3. 在弹出的学期选择界面中选择要导出的学期
4. 等待脚本运行完成，会自动下载对应格式的文件
5. 使用相应的应用导入文件

## 技术实现
- **CSV导出**：生成标准CSV格式，包含课程名称、星期、节数、教师、地点、周数等信息
- **iCal导出**：生成标准iCal格式，包含完整的日历事件信息
- **学期周次获取**：自动调用教务系统API获取准确的学期周次信息
- **时间计算**：根据学期开始日期和课程周数计算准确的课程日期
- **教学时间**：内置标准的教学时间配置，确保时间准确性

## 导出格式说明

### CSV格式
- **适用场景**：导入到WakeUP课程表等课程管理应用
- **包含字段**：课程名称、星期、开始节数、结束节数、老师、地点、周数
- **文件扩展名**：.csv

### iCal格式
- **适用场景**：导入到Google日历、Apple日历等日历应用
- **包含信息**：课程名称、时间、地点、教师、周数、班级等
- **文件扩展名**：.ics

## 时间配置
脚本使用以下教学时间配置（基于学校官方教学运转时间表）：

| 节次 | 开始时间 | 结束时间 |
|------|---------|---------|
| 第1节 | 08:00   | 08:45   |
| 第2节 | 08:50   | 09:35   |
| 第3节 | 09:50   | 10:35   |
| 第4节 | 10:40   | 11:25   |
| 第5节 | 11:30   | 12:15   |
| 第6节 | 13:30   | 14:15   |
| 第7节 | 14:20   | 15:05   |
| 第8节 | 15:20   | 16:05   |
| 第9节 | 16:10   | 16:55   |
| 第10节 | 18:30  | 19:15   |
| 第11节 | 19:20  | 20:05   |
| 第12节 | 20:10  | 20:55   |
| 第13节 | 21:00  | 21:45   |

## 常见问题
1. **导出失败**
   - 检查网络连接
   - 确认学期代码是否正确
   - 查看浏览器控制台的错误信息

2. **时间不准确**
   - 脚本会自动获取学期周次信息，确保时间准确性
   - 若仍有问题，可能是因为学期开始日期与实际不符

3. **iCal导入问题**
   - 确保使用支持iCal格式的日历应用
   - 检查导出的.ics文件是否完整

4. **CSV导入到WakeUP**
   - 打开WakeUP课程表应用
   - 选择「导入课程表」→「从CSV文件导入」
   - 选择导出的CSV文件即可

## 友商项目
- [neu_wisedu2wakeup](https://github.com/CreamPig233/neu_wisedu2wakeup) - 针对金智教育教务系统的课程表导出工具（东北大学）
- [bistu-courses-output](https://github.com/fire007012/bistu-courses-output) - 北京信息科技大学课程表导出工具